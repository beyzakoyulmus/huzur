<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YÄ±ldÄ±zlÄ± DertleÅŸme</title>
    <style>
        /*
         * --- GENEL VE MOBÄ°L UYUMLULUK AYARLARI ---
         */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            /* EkranÄ±n dikey olarak bÃ¼yÃ¼yÃ¼p kÃ¼Ã§Ã¼lmesini engellemek iÃ§in overflow-y: hidden; */
            overflow: hidden; 
            font-family: 'Segoe UI', sans-serif, Arial;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(to bottom, #000428, #004e92);
        }

        body::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: radial-gradient(white, rgba(255,255,255,0.1) 2px, transparent 2px);
            background-size: 50px 50px;
            pointer-events: none;
            opacity: 0.1;
            z-index: 0;
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 50;
            pointer-events: none;
        }

        h1 {
            font-size: 1.8em; /* Mobil iÃ§in biraz kÃ¼Ã§Ã¼ltÃ¼ldÃ¼ */
            margin: 0 10px 30px 10px; /* Kenarlardan boÅŸluk eklendi */
            text-align: center;
            opacity: 0.8;
            z-index: 10;
            text-shadow: 0 0 20px rgba(255,255,255,0.3);
            font-weight: 300;
        }
        
        /*
         * --- INPUT BÃ–LÃœMÃœ ---
         */
        #input-container {
            position: relative;
            z-index: 20;
            width: 90%; /* Mobil cihazlarda daha geniÅŸ yer kaplamasÄ± saÄŸlandÄ± */
            max-width: 700px;
        }

        #textbox {
            width: 100%;
            height: 50px; /* Mobil iÃ§in biraz daha kÃ¼Ã§Ã¼k yÃ¼kseklik */
            padding: 10px 20px;
            font-size: 1.2em; /* Mobil iÃ§in yazÄ± boyutu optimize edildi */
            border: none;
            border-radius: 25px; /* YÃ¼ksekliÄŸe gÃ¶re yuvarlandÄ± */
            background: rgba(255, 255, 255, 0.15);
            color: white;
            outline: none;
            backdrop-filter: blur(10px); /* Blur azaltÄ±ldÄ± */
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
            text-align: left;
            padding-left: 45px;
            box-sizing: border-box; /* Padding'in geniÅŸliÄŸe dahil olmasÄ±nÄ± saÄŸla */
        }

        #textbox:focus {
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
        }

        #textbox::placeholder {
            color: rgba(255, 255, 255, 0.5);
            font-size: 1em;
            font-style: italic;
        }

        /*
         * --- DÄ°ÄžER MOBÄ°L AYARLAR ---
         */
        #audio-control {
            position: fixed; /* position: absolute yerine fixed daha iyi olabilir */
            bottom: 20px;
            right: 20px; /* SaÄŸa yaslandÄ± */
            left: auto;
            color: rgba(255,255,255,0.5);
            cursor: pointer;
            z-index: 100;
            font-size: 14px;
            padding: 5px 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            transition: color 0.3s;
        }
        #audio-control:hover { color: white; }

        /* Mobil Cihazlar iÃ§in Medya Sorgusu (Ä°htiyaÃ§ duyulursa) */
        @media (max-width: 600px) {
            h1 {
                font-size: 1.5em; /* Ã‡ok kÃ¼Ã§Ã¼k ekranlarda daha kÃ¼Ã§Ã¼k baÅŸlÄ±k */
            }
            #textbox {
                font-size: 1.1em;
                height: 45px;
            }
        }

    </style>
</head>
<body>

    <h1>Kelimelerin gÃ¶kyÃ¼zÃ¼ne karÄ±ÅŸsÄ±n...</h1>

    <div id="input-container">
        <input type="text" id="textbox" placeholder="Ä°Ã§inden geÃ§enleri buraya bÄ±rak.. Kimse gÃ¶rmÃ¼yor" autocomplete="off">
    </div>

    <canvas id="sky"></canvas>

    <div id="audio-control" onclick="toggleAudio()">ðŸŽµ YaÄŸmur Sesi: KapalÄ±</div>

    <audio id="rainAudio" loop>
        <source src="rainsounds.mp3" type="audio/mpeg">
    </audio>

    <script>
        const canvas = document.getElementById('sky');
        const ctx = canvas.getContext('2d');
        const input = document.getElementById('textbox');
        const audio = document.getElementById('rainAudio');
        const audioControl = document.getElementById('audio-control');

        let width, height;
        let particles = []; 
        let stars = [];
        
        // --- ZAMANLAMA AYARLARI ---
        let firstStarCreated = false;
        let lastSpecialStarTime = 0;
        const SPECIAL_STAR_INTERVAL = 180000; // 3 dakika (milisaniye cinsinden: 3 * 60 * 1000)

        function resize() {
            // Mobil cihazlarda sanal klavye aÃ§Ä±ldÄ±ÄŸÄ±nda viewport yÃ¼ksekliÄŸi deÄŸiÅŸir. 
            // Bu durumu yÃ¶netmek iÃ§in innerHeight kullanmak en yaygÄ±n Ã§Ã¶zÃ¼mdÃ¼r.
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }
        // Resize olayÄ±na ek olarak, klavye aÃ§Ä±ldÄ±ÄŸÄ±nda oluÅŸabilecek yÃ¼kseklik deÄŸiÅŸimlerini izlemek iÃ§in
        window.addEventListener('resize', resize);
        window.addEventListener('orientationchange', resize);
        resize();

        function random(min, max) { return Math.random() * (max - min) + min; }

        input.addEventListener('input', function(e) {
            const val = input.value;
            const spaceCount = (val.match(/ /g) || []).length;

            if (spaceCount >= 3 && val.length > 0) {
                const charToDrop = val.charAt(0);
                const cursorPos = this.selectionStart;
                this.value = val.substring(1);
                if (cursorPos > 0) {
                    this.setSelectionRange(cursorPos - 1, cursorPos - 1);
                }
                spawnDroppingChar(charToDrop);
            }
        });

        function spawnDroppingChar(char) {
            const rect = input.getBoundingClientRect();
            // Mobil klavyenin yarattÄ±ÄŸÄ± kaymayÄ± telafi etmek zor olduÄŸundan, baÅŸlangÄ±Ã§ pozisyonunu 
            // giriÅŸ kutusunun merkezine gÃ¶re hesaplamak daha gÃ¼venlidir.
            const startX = rect.left + 45; 
            const startY = rect.top + (rect.height / 2) + 8; 

            particles.push({
                char: char,
                x: startX,
                y: startY,
                vx: random(-0.3, 0.3),  
                vy: random(0.8, 1.5),  
                opacity: 1,
                size: 26, 
                rotation: random(-0.05, 0.05)
            });
        }

        // --- GERÃ‡EK 5 KÃ–ÅžELÄ° YILDIZ Ã‡Ä°ZME FONKSÄ°YONU (DeÄŸiÅŸmedi) ---
        function drawFivePointStar(ctx, cx, cy, outerRadius, innerRadius, alpha) {
            let rot = Math.PI / 2 * 3;
            let x = cx;
            let y = cy;
            let step = Math.PI / 5;

            ctx.save();
            ctx.beginPath();
            ctx.moveTo(cx, cy - outerRadius);
            for (let i = 0; i < 5; i++) {
                x = cx + Math.cos(rot) * outerRadius;
                y = cy + Math.sin(rot) * outerRadius;
                ctx.lineTo(x, y);
                rot += step;

                x = cx + Math.cos(rot) * innerRadius;
                y = cy + Math.sin(rot) * innerRadius;
                ctx.lineTo(x, y);
                rot += step;
            }
            ctx.lineTo(cx, cy - outerRadius);
            ctx.closePath();
            
            ctx.fillStyle = `rgba(255, 255, 220, ${alpha})`;
            ctx.shadowBlur = 20; 
            ctx.shadowColor = "rgba(255, 255, 255, 0.8)";
            ctx.fill();
            ctx.restore();
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);

            // --- YILDIZLARIN Ã‡Ä°ZÄ°MÄ° ---
            stars.forEach(star => {
                if (star.isSpecial) {
                    // Ã–ZEL PARLAK YILDIZ (5 KÃ–ÅžELÄ°)
                    const pulse = 1 + Math.sin(Date.now() * 0.003) * 0.15; 
                    drawFivePointStar(ctx, star.x, star.y, star.radius * 3 * pulse, star.radius * 1.5 * pulse, star.alpha);
                } else {
                    // NORMAL NOKTA YILDIZ
                    ctx.beginPath();
                    ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                    const twinkle = 0.5 + Math.random() * 0.5;
                    ctx.fillStyle = `rgba(255, 255, 255, ${star.alpha * twinkle})`;
                    ctx.shadowBlur = 0; 
                    ctx.fill();
                }
            });

            // --- HARFLERÄ°N Ã‡Ä°ZÄ°MÄ° ---
            for (let i = particles.length - 1; i >= 0; i--) {
                let p = particles[i];

                p.y += p.vy;      
                p.x += p.vx;      
                p.opacity -= 0.005; 
                p.size -= 0.02;    

                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.rotation);
                ctx.font = `400 ${p.size}px 'Segoe UI', sans-serif`; 
                ctx.fillStyle = `rgba(255, 255, 255, ${p.opacity})`;
                ctx.fillText(p.char, 0, 0);
                ctx.restore();

                // Harf kaybolup yÄ±ldÄ±za dÃ¶nÃ¼ÅŸÃ¼rken
                if (p.opacity <= 0.05 || p.y > height) {
                    
                    let isSpecialStar = false;
                    const now = Date.now();

                    // --- MANTIK: Ä°LK YILDIZ VEYA 3 DAKÄ°KA SONRASI ---
                    if (!firstStarCreated) {
                        isSpecialStar = true;
                        firstStarCreated = true;
                        lastSpecialStarTime = now;
                    } 
                    else if (now - lastSpecialStarTime > SPECIAL_STAR_INTERVAL) {
                        isSpecialStar = true;
                        lastSpecialStarTime = now;
                    }

                    stars.push({
                        x: Math.random() * width, 
                        y: Math.random() * (height * 0.6),
                        radius: isSpecialStar ? 2.5 : Math.random() * 1.5 + 0.5, 
                        alpha: Math.random() * 0.5 + 0.5,
                        isSpecial: isSpecialStar 
                    });
                    particles.splice(i, 1);
                }
            }

            requestAnimationFrame(animate);
        }
        animate();

        function toggleAudio() {
            if (audio.paused) {
                // Mobil cihazlarda sesin Ã§almasÄ± iÃ§in kullanÄ±cÄ±nÄ±n bir etkileÅŸimi ÅŸarttÄ±r.
                // Bu fonksiyon zaten bir tÄ±klama olayÄ± iÃ§inde olduÄŸu iÃ§in Ã§alÄ±ÅŸacaktÄ±r.
                audio.play().catch(e => console.log("Ses Ã§alma hatasÄ±:", e));
                audioControl.innerHTML = "ðŸ”‡ YaÄŸmur Sesi: AÃ§Ä±k";
            } else {
                audio.pause();
                audioControl.innerHTML = "ðŸŽµ YaÄŸmur Sesi: KapalÄ±";
            }
        }
        
        // Sesin Ã§almasÄ± iÃ§in ilk etkileÅŸimden sonra (Ã¶nerilen bir kalÄ±p)
        document.body.addEventListener('click', () => {
             // KullanÄ±cÄ± ilk tÄ±kladÄ±ÄŸÄ±nda ses Ã§alma denemesi yapÄ±labilir. 
             // Ancak ben bunu toggleAudio fonksiyonuna bÄ±raktÄ±m.
        }, {once:true});

    </script>
</body>
</html>
